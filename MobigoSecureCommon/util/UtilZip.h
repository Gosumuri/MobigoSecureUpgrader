#pragma once

////////////////////////////////////////////////////////////////////////////////
//	http://www.codeproject.com/Articles/7530/Zip-Utils-clean-elegant-simple-C-Win
//  http://blog.naver.com/binoz/40044276494
//  http://developerworrick.blogspot.kr/2016/01/mfc-zip.html
////////////////////////////////////////////////////////////////////////////////


////////////////////////////////////////////////////////////////////////////////
// include
////////////////////////////////////////////////////////////////////////////////

////////////////////////////////////////////////////////////////////////////////
// define
////////////////////////////////////////////////////////////////////////////////

#define		MY_MSG_PRORGESS_ZIP_INIT			( WM_USER + 103 ) 
#define		MY_MSG_PRORGESS_ZIPPING				( WM_USER + 104 ) 
#define		UNZIP_BUF_SIZE						( 16384         )

////////////////////////////////////////////////////////////////////////////////
// macro
////////////////////////////////////////////////////////////////////////////////

////////////////////////////////////////////////////////////////////////////////
// class declare
////////////////////////////////////////////////////////////////////////////////

class AFX_EXT_CLASS CUtilZip
{
public:
	CUtilZip(void);
	~CUtilZip(void);

////////////////////////////////////////////////////////////////////////////////
// member data
////////////////////////////////////////////////////////////////////////////////

private :
    static BOOL     m_bStopZip;
    static BOOL     m_bStopUnzip;

////////////////////////////////////////////////////////////////////////////////
// member function
////////////////////////////////////////////////////////////////////////////////

// get/set
public :
    static void SetStopZip(   BOOL bStopZip )        { m_bStopZip = TRUE;   }
    static void SetStopUnzip( BOOL bStopUnzip )      { m_bStopUnzip = TRUE; }
    static BOOL IsStopZip()                          { return m_bStopZip;   }
    static BOOL IsStopUnzip()                        { return m_bStopUnzip; }

// zip/unzip
public:
    static CString File2Zip( CString strFilePath, CString strZipPath = "", HWND hProgressWnd = NULL );

	static void Dir2Zip( CString strDirPath, CString strZipPath = "", HWND hProgressWnd = NULL );
	static void Zip2Dir( CString strZipPath, CString strDirPath = "", HWND hProgressWnd = NULL );
};