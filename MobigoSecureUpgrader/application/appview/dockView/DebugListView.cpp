////////////////////////////////////////////////////////////////////////////////
// include
////////////////////////////////////////////////////////////////////////////////

#include "stdafx.h"
#include "MobigoSecureUpgrader.h"
#include "DebugListView.h"

////////////////////////////////////////////////////////////////////////////////
// define
////////////////////////////////////////////////////////////////////////////////


////////////////////////////////////////////////////////////////////////////////
// macro
////////////////////////////////////////////////////////////////////////////////

IMPLEMENT_DYNCREATE(CDebugListView, CFormView)

BEGIN_MESSAGE_MAP(CDebugListView, CFormView)
	ON_WM_SIZE()
END_MESSAGE_MAP()

////////////////////////////////////////////////////////////////////////////////
// constructor / destructor
////////////////////////////////////////////////////////////////////////////////

CDebugListView::CDebugListView()
	: CFormView(CDebugListView::IDD)
{
}

CDebugListView::~CDebugListView()
{
}

////////////////////////////////////////////////////////////////////////////////
// virtual 
////////////////////////////////////////////////////////////////////////////////

void CDebugListView::DoDataExchange(CDataExchange* pDX)
{
	CFormView::DoDataExchange(pDX);

	DDX_Control(pDX, IDC_LC_DEBUG,	m_lcDebug );
}

////////////////////////////////////////////////////////////////////////////////
// debug & diagnostics
////////////////////////////////////////////////////////////////////////////////

#ifdef _DEBUG
void CDebugListView::AssertValid() const
{
	CFormView::AssertValid();
}

void CDebugListView::Dump(CDumpContext& dc) const
{
	CFormView::Dump(dc);
}
#endif //_DEBUG

////////////////////////////////////////////////////////////////////////////////
// event handler
////////////////////////////////////////////////////////////////////////////////

void CDebugListView::OnSize(UINT nType, int cx, int cy)
{
	CFormView::OnSize(nType, cx, cy);

	// TODO: Add your message handler code here
	if( ::IsWindow(m_lcDebug.m_hWnd ) ) {
		int nLeft   = -1;
		int nTop    = -1;
		int nWidth	= cx + 2;
		int nHeight = cy + 2;

		m_lcDebug.MoveWindow( nLeft, nTop, nWidth, nHeight );	
	}

    SetScrollSizes(MM_TEXT, CSize(cx, cy));
}

void CDebugListView::OnInitialUpdate()
{

	CFormView::OnInitialUpdate();
	// TODO: Add your specialized code here and/or call the base class

	// 1. fit size
	CRect rect;
	GetClientRect( &rect );
	m_lcDebug.MoveWindow(	rect.top     - 1, 
							rect.bottom  - 1, 
							rect.Width() + 2, 
							rect.Height()+ 2 );
	// 2. init
	m_lcDebug.Init();

}
